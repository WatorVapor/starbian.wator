graph G {
  graph[
    layout = circo
  ];
  splines="curved";
  
  device_iot_11 -- broker1 [label="pub/sub" fontcolor="red" color="red"];
  device_iot_12 -- broker1 [label="pub/sub" fontcolor="red" color="red"];
  device_iot_31 -- broker3 [label="pub/sub" fontcolor="green" color="green"];
  device_iot_32 -- broker3 [label="pub/sub" fontcolor="green" color="green"];

  viewer_iot_21 -- broker2 [label="pub/sub" fontcolor="blue" color="blue"];
  owner_iot_22 -- broker2 [label="pub/sub" fontcolor="blue" color="blue"];
  viewer_iot_41 -- broker4 [label="pub/sub" fontcolor="cyan" color="cyan"];
  owner_iot_42 -- broker4 [label="pub/sub" fontcolor="cyan" color="cyan"];

  subgraph cluster_broker {
    broker1 -- broker2 [label="dht" fontcolor="orange" color="orange"];
    broker1 -- broker3 [label="dht" fontcolor="orange" color="orange"];
    broker1 -- broker4 [label="dht" fontcolor="orange" color="orange"];

    broker3 -- broker4 [label="dht" fontcolor="orange" color="orange"];
  }

  device_iot_11 [shape=egg label = "device ipv4" fontcolor="red" color="red"];
  device_iot_12 [shape=egg label = "device ipv6" fontcolor="red" color="red"];

  viewer_iot_21 [shape=tab label = "viewer ipv4 " fontcolor="blue" color="blue"];
  owner_iot_22 [shape=component label = "owner ipv4" fontcolor="blue" color="blue"];

  device_iot_31 [shape=egg label = "device ipv6" fontcolor="green" color="green"];
  device_iot_32 [shape=egg label = "device ipv6" fontcolor="green" color="green"];

  viewer_iot_41 [shape=tab label = "viewer ipv6" fontcolor="cyan" color="cyan"];
  owner_iot_42 [shape=component label = "owner ipv4" fontcolor="cyan" color="cyan"];

  
  broker1 [shape=circle  label = "broker globalip v4/v6" fontcolor="red" color="red"];
  broker2 [shape=circle  label = "broker globalip v4" fontcolor="blue" color="blue"];
  broker3 [shape=circle  label = "global brokerip v6" fontcolor="green" color="green"];
  broker4 [shape=circle  label = "global brokerip v6" fontcolor="cyan" color="cyan"];
  
}
